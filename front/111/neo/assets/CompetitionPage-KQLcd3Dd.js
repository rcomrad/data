import{j as e,r,b as x}from"./index--C9Zf2yg.js";import{G as u}from"./competition-FRa9cu2U.js";import{G as j}from"./users-My4gugrs.js";import{A as c}from"./config-ZEIqkGks.js";function f(t){return e.jsx("div",{className:"mt-4",style:{maxHeight:"50vh",overflowY:"scroll"},children:e.jsx("ul",{className:"list-group",children:t.shortQuestions.map(a=>e.jsx("a",{className:`list-group-item list-group-item-action ${a.problem_id==t.activeQuestionId?"active":""}`,role:"button",onClick:()=>{var n;return(n=t.onQuestionClick)==null?void 0:n.call(t,a.problem_id)},children:a.name},a.problem_id))})})}async function v(t){return(await(await fetch(`${c}/get/if/competition_problem/competition_id=${t}`)).json()).competition_problems}async function N(t,a){let o=await(await fetch(`${c}/get_problem/${a}/${t}`)).json();return o.submission=o.submission.map(s=>({...s,date_val:new Date(s.date_val)})),o}async function g(t,a,n){if(n.name==null)return;const i=new FormData;i.append("file",n),i.append("user_id",t.toString()),i.append("problem_id",a.toString()),i.append("filename",n.name),await fetch(`${c}/submit`,{method:"POST",body:i})}function p(t){var i,o;const[a,n]=r.useState({});return e.jsx(e.Fragment,{children:t.problem.id!=-1?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"modal fade",id:"exampleModal","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h1",{className:"modal-title fs-5",id:"exampleModalLabel",children:"История решений"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("p",{className:"text-secondary",children:"Данные обновляются после перезагрузки страницы"}),e.jsxs("table",{className:"table table-bordered table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Дата"}),e.jsx("th",{children:"Результат"})]})}),e.jsx("tbody",{children:(i=t.problem.submission)==null?void 0:i.map((s,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:`${s.date_val.getDate()<10?"0":""}${s.date_val.getDate()}.${s.date_val.getMonth()+1<10?"0":""}${s.date_val.getMonth()+1} ${s.date_val.getHours()<10?"0":""}${s.date_val.getHours()}:${s.date_val.getMinutes()<10?"0":""}${s.date_val.getMinutes()}:${s.date_val.getSeconds()<10?"0":""}${s.date_val.getSeconds()}`}),e.jsx("td",{children:s.verdict})]},l))})]})]}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Close"})})]})})}),e.jsxs("div",{className:"d-flex flex-column h-100 justify-content-between",children:[e.jsx("div",{className:"fs-3 pb-4 border-bottom ",children:t.problem.name}),e.jsxs("div",{style:{maxHeight:"50vh",overflowY:"scroll"},children:[e.jsx("div",{className:"",dangerouslySetInnerHTML:{__html:t.problem.legend??""}}),e.jsx("div",{className:"mt-3 fw-bold",children:"Формат ввода: "}),e.jsx("div",{className:"",dangerouslySetInnerHTML:{__html:t.problem.input_format??""}}),e.jsx("div",{className:"mt-3 fw-bold",children:"Формат вывода: "}),e.jsx("div",{className:"",dangerouslySetInnerHTML:{__html:t.problem.output_format??""}}),e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"fw-bold",children:"Ограничение по времени:"})," ",t.problem.time_limit," мсек"]}),e.jsxs("div",{className:"",children:[e.jsx("span",{className:"fw-bold",children:"Ограничение по памяти:"})," ",t.problem.memory_limit," МБ"]}),e.jsx("div",{className:"mt-3 fw-bold",children:"Примеры тестов:"}),e.jsxs("table",{className:"mt-1 table table-bordered table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ввод"}),e.jsx("th",{children:"Вывод"})]})}),e.jsx("tbody",{children:(o=t.problem.tests)==null?void 0:o.map((s,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("pre",{children:s.input})}),e.jsx("td",{children:e.jsx("pre",{children:s.output})})]},l))})]})]}),e.jsxs("div",{className:"fs-5 pt-1 border-top",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Код ответа (принимается Python, C++, Pascal)"}),e.jsx("input",{className:"form-control",type:"file",id:"formFile",onChange:s=>{var l;n(((l=s.target.files)==null?void 0:l[0])??{})}})]}),e.jsxs("div",{className:"d-flex",children:[e.jsx("button",{className:"btn btn-primary mt-3 me-3",onClick:()=>{var s;(s=t.onAnswer)==null||s.call(t,a)},children:"Отправить"}),e.jsx("button",{className:"btn btn-outline-primary mt-3 me-3 ","data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:()=>{var s;(s=t.onAnswer)==null||s.call(t,a)},children:"История решений"})]})]})]})]}):e.jsx("div",{className:"d-flex flex-column h-100 justify-content-center align-items-center",children:e.jsx("h1",{children:"Выберите вопрос из списка слева"})})})}function S(){const t=x(),a=j()??{},[n,i]=r.useState([]),[o,s]=r.useState({}),[l,m]=r.useState(-1),[b,h]=r.useState({});return r.useEffect(()=>{v(parseInt(t.id??"-1")).then(d=>{i(d),d.length>0&&m(-1)}),u(parseInt(t.id??"-1")).then(d=>{s(d??{})})},[]),r.useEffect(()=>{l!=-1?N(a.id,l).then(d=>{console.log(d),h(d)}):h({id:-1})},[l]),e.jsx("div",{className:"container-fluid",children:e.jsxs("div",{className:"row p-4 full-height",children:[e.jsxs("div",{className:"col-3 pe-4 border-end",children:[e.jsx("div",{className:"fs-3 pb-4 border-bottom ",children:o.name}),e.jsx(f,{shortQuestions:n,activeQuestionId:l,onQuestionClick:d=>m(d)})]}),e.jsx("div",{className:"col-9",children:e.jsx(p,{problem:b,onAnswer:d=>{g(a.id,l,d)}},l)})]})})}export{S as default};
